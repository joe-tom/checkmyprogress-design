"use strict";var Ajax=function(t){var e=new XMLHttpRequest;return e.open(t.type,t.url,!0),"POST"==t.type&&e.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),new Promise(function(n,o){e.onload=function(){e.status>=200&&e.status<400?n(e.responseText):o(e)},e.onerror=function(){o(e)},e.send(t.data)})},LOAD_CHARACTER="O",Contact=new Vue({el:"#contact__form",data:{form:{name:"",email:"",school:"",district:"",phone:"",subject:"",message:"",contactSubmit:"Send Message"},sendVal:"SEND",disabled:!1,interval:0},methods:{check:null,post:null,send:null,report:null,startL:null,endL:null}});Contact.send=function(){Contact.check().then(function(){Contact.startL(),Contact.post().then(function(){Contact.endL()}).catch(function(){Contact.endL()})}).catch(function(t){Contact.report(t)})},Contact.startL=function(){var t=this;this.disabled=!0;var e=0;this.interval=setInterval(function(){e++%4==0?t.sendVal="":t.sendVal+=LOAD_CHARACTER},200)},Contact.endL=function(){var t=this;clearInterval(this.interval),this.sendVal="SENT!",setTimeout(function(){t.disabled=!1,t.sendVal="SEND"},1e3)},Contact.report=function(){},Contact.check=function(){return new Promise(function(t,e){t()})},Contact.post=function(){var t="";for(var e in this.form)t+=e+"="+this.form[e]+"&";return t=t.slice(0,-1),console.log(t),Ajax({url:"/login.post",type:"POST",data:t})};var PARENT_QUOTES=[{contents:"I think the site is great. . . . I review the kids marks regularly as it is a great way to keep on top of things. I wished all the teachers used it.",author:"Ryan and Barb"},{contents:"I find this a much better system . . . to be able to look at any time at his progress and to be able to get a hold of you through email, makes my life so much easier and feel I am still able to be productive part of his education without constantly nagging him.",author:"Theresa and Mike"},{contents:"I think receiving information online is terrific",author:"Shari"},{contents:"I love receiving Jordan's marks/interims via email . . . This helps keep him accountable for his work and allows me to see how he is doing at times other than report cards.",author:"Doug"}],TEACHER_QUOTES=[{contents:"This program is brilliant, students and parents can have regular access to marks which makes the life of the teacher much easier (fewer phone calls home, etc.) It's really easy to use. Teachers can access it from any computer.",author:"Soraya"},{contents:"Your program has had an enormous impact at our school. We appreciate everything you are doing with it and sharing it with our school.",author:"Rob"},{contents:"The parents love this program. I have had lots of positive feedback on the increase in student accountability.",author:"Bruce"}];new Vue({el:".inner--feedback",data:{quotes:{teacher:TEACHER_QUOTES,parents:PARENT_QUOTES}}});var BASE_URL="https://checkmyprogress.ca",ACCOUNT_LOGIN_TYPES=["student","teacher","caseManager","admin"],ACCOUNT_TYPES=["Student / Parent","Teacher","Case Mgr","Admin"];ACCOUNT_TYPES=ACCOUNT_TYPES.map(function(t,e){return{name:t,selected:!1,login:ACCOUNT_LOGIN_TYPES[e]}});var Ajax=function(t){var e=new XMLHttpRequest;return e.open(t.type,t.url,!0),"POST"==t.type||e.setRequestHeader("Content-Type","application/json"),new Promise(function(n,o){e.onload=function(){e.status>=200&&e.status<400?n(e.response):o(e)},e.onerror=function(){o(e)},e.send(t.data)})},Login=new Vue({el:"#login__container",data:{ACCOUNT_TYPES:ACCOUNT_TYPES,lists:{districts:[],schools:[]},district:!1,school:!1,type:document.location.hash.substr(1),lastname:"",password:""},methods:{login:null,fetch:null}});Login.select=function(t){this.type=t.login,document.location.hash=t.login},Login.login=function(){var t={apiRequest:"loginCheck",userType:this.type,districtAutoID:this.district,schoolAutoID:this.school,username:this.lastname,password:this.password};Ajax({type:"POST",url:BASE_URL+"/api/login.php",data:JSON.stringify(t)}).then(function(t){t=JSON.parse(t),console.log(t),t.token&&(localStorage.token=t.token,document.location.reload())}).catch(function(t){})},Login.fetch=function(){var t=this;Ajax({type:"POST",url:BASE_URL+"/api/login.php",data:JSON.stringify({appRequest:"getDistrictsSchools"})}).then(function(e){(e=JSON.parse(e)).districts.forEach(function(e){return t.lists.districts.push(e)}),e.schools.forEach(function(e){return t.lists.schools.push(e)})}).catch(function(t){})},Login.fetch();